---
import type { CollectionEntry } from "astro:content";
import { getProjectLink } from "../utils/links";
interface Props {
    projects: CollectionEntry<"projects">[];
}

const { projects } = Astro.props;
---

<div class="projectlist">
    {
        projects
            .filter((project) => project.data.images?.length > 0)
            .map((project) => {
                const imageMeta = project.data.images[0].default;
                const imageSrc = imageMeta;
                const projectLink = getProjectLink(project.slug);
                const netlifyImageUrl = `/.netlify/images?url=${encodeURIComponent(
                    imageSrc,
                )}&w=755&h=488&fit=cover`;

                return (
                    <div class="projectlist-item">
                        <a
                            class="projectlist-item-imgwrp"
                            href={projectLink}
                            style={`background-color:${project.data.backgroundColor}`}
                        >
                            <img
                                src={netlifyImageUrl}
                                alt={project.data.title}
                                loading="lazy"
                                sizes="(min-width: 800px) 50vw, 100vw"
                                width="755"
                                height="488"
                                decoding="async"
                            />
                        </a>
                        <p class="projectlist-item-desc">
                            <a href={projectLink} class="t-lighter">
                                {project.data.title}
                            </a>
                            <br />
                            <a href={projectLink} class="t-secondary">
                                (CATEGORY)
                            </a>
                        </p>
                    </div>
                );
            })
    }
</div>
